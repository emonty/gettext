2003-05-18  Bruno Haible  <bruno@clisp.org>

	* Makefile.msvc (DEBUGFLAGS): New variable.
	(gettextlib.lib): Use it.

2003-05-17  Bruno Haible  <bruno@clisp.org>

	* gettext-0.12 released.

2003-05-17  Bruno Haible  <bruno@clisp.org>

	* Makefile.msvc (OBJECTS): Remove strpbrk.obj.
	(strpbrk.obj): Remove rule.

	* w32spawn.h (dup_noinherit): Cast _get_osfhandle result and
	_open_osfhandle argument, to avoid warnings.
	(prepare_spawn): Add a cast.
	* execute.c (execute) [WIN32]: Don't call wait_subprocess; the
	return value from spawnvp is already the exit code.

2003-05-10  Bruno Haible  <bruno@clisp.org>

	* linebreak.c (iconv_string_length): Don't return -1 just because the
	string is longer than 4 KB.

2003-05-09  Bruno Haible  <bruno@clisp.org>

	* error.c: Update from gnulib with modifications.
	* unlocked-io.h: New file, from gnulib.
	* Makefile.am (libgettextlib_la_SOURCES): Add it.

2003-05-09  Bruno Haible  <bruno@clisp.org>

	* canonicalize.c: Add #ifdef around versioned_symbol. Avoids an
	"extraneous semicolon" warning from Tru64 cc.

2003-05-06  Bruno Haible  <bruno@clisp.org>

	* Makefile.am (DEFS): Fix spelling of DEPENDS_ON_LIBICONV.
	* Makefile.msvc (CFLAGS): Likewise.

2003-05-03  Bruno Haible  <bruno@clisp.org>

	Upgrade to Unicode-4.0.
	* linebreak.c (nonspacing_table_data): Change width of U+00AD,
	U+0350..U+0357, U+035D..U+035F, U+0600..U+0603, U+0610..U+0615,
	U+0656..U+0658, U+0A01, U+0AE2..U+0AE3, U+0CBC, U+17B4..U+17B5,
	U+17DD, U+1920..U+1922, U+1927..U+192B, U+1932, U+1939..U+193B
	from 1 to 0. Change width of U+0CBF, U+0CC6, U+180E from 0 to 1.
	(uc_width): Change width of U+4DC0..U+4DFF from 2 to 1. Change width
	of U+2A6D7..U+2F7FF, U+2FA1E..U+2FFFD, U+30000..U+3FFFD from 1 to 2.
	Change width of U+E0100..U+E01EF from 1 to 0.

2003-05-02  Bruno Haible  <bruno@clisp.org>

	Support for libtool-1.5.
	* progname.c (set_program_name): Remove a leading "<dirname>/.libs/lt-"
	or "<dirname>/.libs/", not only "lt-".

2003-04-12  Bruno Haible  <bruno@clisp.org>

	* Makefile.vms: New variables ABIFLAGS, DEFS. Avoid rules with no
	lines. Update library creation rule. Don't use the force target.
	Correct wildcard syntax. Create fnmatch.h.
	Suggested by Jouk Jansen <joukj@hrem.stm.tudelft.nl>.

2003-04-12  Bruno Haible  <bruno@clisp.org>

	* localcharset.c (get_charset_aliases): Add special case for VMS.

2003-04-10  Bruno Haible  <bruno@clisp.org>

	* findprog.c (find_in_path): Use 'bool' and eaccess().
	Suggested by Paul Eggert.

2003-04-06  Bruno Haible  <bruno@clisp.org>

	* progname.c: Move out all methods depending on ENABLE_RELOCATABLE...
	* progreloc.c: ... to here. New file.
	* Makefile.am (libgettextlib_la_SOURCES): Add progreloc.c.
	* Makefile.msvc (OBJECTS): Add progreloc.obj.
	(progreloc.obj): New rule.
	* Makefile.vms (OBJECTS): Add progreloc.obj.
	(progreloc.obj): New rule.

2003-04-05  Bruno Haible  <bruno@clisp.org>

	* relocatable.c: Rely on DEPENDS_ON_LIBCHARSET, DEPENDS_ON_LIBICONV,
	DEPENDS_ON_LIBINTL, not on NO_LIBRARIES.
	* Makefile.am (DEFS): Define DEPENDS_ON_LIBINTL and DEPENDS_ON_LIBICONV,
	for relocatable.c.
	* Makefile.msvc (CFLAGS): Also define DEPENDS_ON_LIBINTL and
	DEPENDS_ON_LIBCONV.

2003-04-05  Bruno Haible  <bruno@clisp.org>

	* relocatable.c (_GNU_SOURCE): Define, to ensure getline() gets
	declared by <stdio.h>.

2003-03-30  Bruno Haible  <bruno@clisp.org>

	* xgetcwd.c: Include <unistd.h>.

2003-04-03  Bruno Haible  <bruno@clisp.org>

	* w32spawn.h (dup_noinherit): Signal an error instead of returning -1.
	* execute.c: Reorder includes.
	* pipe-bidi.c: Likewise.
	* pipe-in.c: Likewise.
	* pipe-out.c: Likewise.

2003-04-02  Bruno Haible  <bruno@clisp.org>

	* binary-io.h: Cosmetics. Suggested by Jim Meyering.

2003-03-30  Bruno Haible  <bruno@clisp.org>

	* Makefile.vms: New file.
	* Makefile.am (EXTRA_DIST): Add Makefile.vms.
	* execute.c (open): #undef before redefining it. Needed for VMS.
	* pipe-in.c (open): Likewise.
	* pipe-out.c (open): Likewise.

2003-03-31  Bruno Haible  <bruno@clisp.org>

	* sh-quote.c (shell_quote_length, shell_quote_copy): Handle empty
	argument string correctly.

2003-03-30  Bruno Haible  <bruno@clisp.org>

	* progname.c (ISSLASH, HAS_DEVICE, IS_PATH_WITH_DIR,
	FILESYSTEM_PREFIX_LEN): New macros.
	(maybe_executable): Make a nop on Woe32.
	(find_executable) [WIN32]: Fix compilation.

	* relocatable.h (RELOCATABLE_DLL_EXPORTED): New macro.

	* w32spawn.h: New file.
	* execute.c: Add alternative implementation using native Woe32 API.
	* pipe-bidi.c: Likewise.
	* pipe-in.c: Likewise.
	* pipe-out.c: Likewise.
	* wait-process.c: Likewise.
	* Makefile.am (libgettextlib_la_SOURCES): Add w32spawn.h.

	* pipe.h (DEV_NULL): New macro.
	* javacomp.c (compile_java_class): Use DEV_NULL instead of "/dev/null".

	* pipe-bidi.c (STDERR_FILENO): Provide a fallback value.
	* pipe-in.c (STDERR_FILENO): Likewise.
	* pipe-out.c (STDERR_FILENO): Likewise.

	* copy-file.c (copy_file_preserving): Don't set owner if the function
	chown() doesn't exist.

2003-03-17  Bruno Haible  <bruno@clisp.org>

	Native Woe32/MSVC support.
	* Makefile.msvc: New file.
	* Makefile.am (EXTRA_DIST): Add it.

2003-03-28  Bruno Haible  <bruno@clisp.org>

	* copy-file.h (copy_file_preserving): Renamed from copy_file.
	* copy-file.c (copy_file_preserving): Renamed from copy_file.
	Preserve the owner and group as well.

2003-02-28  Bruno Haible  <bruno@clisp.org>

	Support for relocatable installation.
	* canonicalize.h: New file.
	* canonicalize.c: New file, from glibc 2.3.1 with modifications.
	* relocatable.h: New file.
	* relocatable.c: New file.
	* relocwrapper.c: New file.
	* strerror.c: New file, from gnulib with modifications.
	* xreadlink.h: New file, from gnulib with modifications.
	* xreadlink.c: New file, from gnulib with modifications.
	* progname.h (set_program_name_and_installdir): New declaration.
	(set_program_name) [ENABLE_RELOCATABLE]: Define as macro.
	(get_full_program_name): New declaration.
	* progname.c: Include xreadlink.h, canonicalize.h, relocatable.h.
	(executable_fd): New variable.
	(maybe_executable): New function.
	(find_executable): New function.
	(executable_fullname): New variable.
	(prepare_relocate): New function.
	(set_program_name_and_installdir): New function.
	(get_full_program_name): New function.
	* localcharset.c: Include relocatable.h.
	(get_charset_aliases): Relocate LIBDIR value.
	* xmalloc.h (xalloc_die): New declaration.
	* xmalloc.c (xalloc_die): New function.
	(fixup_null_alloc): Use it.
	* Makefile.am (libgettextlib_la_SOURCES): Add xreadlink.h, xreadlink.c.
	(LIBADD_SOURCE): Add canonicalize.h, canonicalize.c, memmove.c,
	relocatable.h, relocatable.c, strerror.c.
	(UNUSED_SOURCE): Remove memmove.c.
	(EXTRA_DIST): Add relocwrapper.c.

2003-02-28  Bruno Haible  <bruno@clisp.org>

	* localcharset.h: Change copyright to LGPL. Enclose declaration in
	extern "C", for C++ compilers.
	* localcharset.c: Drop C linkage declaration.

2003-01-29  Bruno Haible  <bruno@clisp.org>

	* config.charset: Add an alias for CP1251 on Solaris.
	Reported by Hidetoshi Tajima <hidetoshi.tajima@sun.com>.

2003-02-18  Bruno Haible  <bruno@clisp.org>

	* copy-file.c: Include safe-read.h.
	(copy_file): Simplify code by using safe_read() instead of read().

2003-02-12  Bruno Haible  <bruno@clisp.org>

	* Makefile.am (EXTRA_DIST): Add ChangeLog.0.


See ChangeLog.0 for earlier changes.
