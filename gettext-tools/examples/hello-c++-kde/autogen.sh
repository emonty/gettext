#!/bin/sh
# Example for use of GNU gettext.
# Copyright (C) 2003 Free Software Foundation, Inc.
# This file is in the public domain.
#
# Script for regenerating all autogenerated files.

kdedir=
for d in /usr/lib/kde /usr/local/kde /usr/local /usr/kde /usr /opt/kde3 /opt/kde $KDEDIR; do
  if test -f $d/share/apps/kdelibs/admin/cvs.sh; then
    kdedir=$d
    break
  fi
done
if test -z "$kdedir"; then
  echo "*** KDE directory not found. Try setting KDEDIR." 1>&2
  exit 1
fi

cp -a $kdedir/share/apps/kdelibs/admin .
sed -e s/AC_FOREACH/INCOMPATIBLE_FOREACH/g < $kdedir/share/apps/kdelibs/admin/acinclude.m4.in > admin/acinclude.m4.in

autopoint -f # was: gettextize -f -c
mv config.rpath admin/config.rpath
rm -f mkinstalldirs
rm po/Makevars.template
rm po/Rules-quot
rm po/boldquot.sed
rm po/en@boldquot.header
rm po/en@quot.header
rm po/insert-header.sin
rm po/quot.sed

sh admin/cvs.sh cvs

cd po
for f in *.po; do
  if test -r "$f"; then
    lang=`echo $f | sed -e 's,\.po$,,'`
    msgfmt -c -o $lang.gmo $lang.po
  fi
done
cd ..
